swagger: '2.0'
info:
  version: '1.0.0'
  title: 'Gamification Server'
  description: "A simple Gamification server for application developpers. It allows
  them to manage their gamification Application"
host: "localhost:8080"
basePath: "/api"
schemes:
  - "http"

paths:
  /badge:
    post:
      tags:
        - "badges"
      summary: "Create a badge for your app"
      description: "Post a badge with an ID"
      operationId: 'createBadge'
      consumes:
        - application/json
      parameters:
        - $ref: '#/parameters/badge'
      responses:
        '201':
          description: created
          schema:
            type: object
        '400':
          description: already exist
          schema:
            type: object
    put:
      tags:
        - "badges"
      description: modify the "id" badge of the "id" app
      operationId: modifiyBadge
      consumes:
        - application/json
      parameters:
        - $ref: '#/parameters/badge'
        - $ref: '#/parameters/badgeName'
      responses:
        '201':
          description: modified
          schema:
            type: boolean
          
    delete:
      tags:
        - "badges"
      description: delete the requested bage
      operationId: deleteBadge
      produces:
        - application/json
      parameters:
        - $ref: '#/parameters/badge'
      responses:
        '200':
          description: deleted
          schema:
            type: object
        '400':
          description: could not be found
          schema:
            type: object

  /badge/{badgeName}:
    get:
      tags:
        - "badges"
      description: get the requested bage
      operationId: getBadge
      produces:
        - application/json
      parameters:
        - $ref: '#/parameters/appKey'
        - $ref: '#/parameters/badgeName'
      responses:
        '200':
          description: success
          schema:
            $ref: '#/definitions/Badge'


  /badges:
    get:
      tags:
        - "badges"
      description: get the list of the application badges
      operationId: getBadges
      produces:
        - application/json
      parameters:
        - $ref: '#/parameters/appKey'
      responses:
        '200':
          description: success
          schema:
            type: array
            items:
              $ref: '#/definitions/Badge'

  /pointScale:
    post:
      tags:
        - "pointScales"
      description: create a pointScale
      operationId: createPointScale
      consumes:
        - application/json
      parameters:
        - $ref: '#/parameters/pointScale'
      responses:
        '201':
          description: created
          schema:
            type: object
        '400':
          description: already exist
          schema:
            type: object
    put:
      tags:
        - "pointScales"
      description: update a pointScale
      operationId: updatePointScale
      consumes:
        - application/json
      parameters:
        - $ref: '#/parameters/pointScale'
      responses:
        '201':
          description: created
          schema:
            type: object
        '400':
          description: failed to update the pointScale
          schema:
            type: object

  /pointScales/{pointScaleName}/{username}:
    get:
      tags:
        - "pointScales"
      description: return the points the user have
      operationId: getPoints
      parameters:
        - $ref: '#/parameters/pointScaleName'
        - $ref: '#/parameters/appKey'
        - $ref: '#/parameters/username'
      produces:
        - application/json
      responses:
        '200':
          description: success
          schema:
            type: integer

  /pointScales/{pointScaleName}/users:
    get:
      tags:
        - "pointScales"
      description: return the list of all the users in the pointScale and the points they have
      operationId: getAllUsersFromPointScale
      parameters:
        - $ref: '#/parameters/appKey'
        - $ref: '#/parameters/pointScaleName'
      produces:
        - application/json
      responses:
        '200':
          description: success
          schema:
            type: array
            items:
              $ref: '#/definitions/Badge'


  /rule:
    post:
      tags:
        - "rules"
      description: create a rule for an app
      operationId: createRule
      consumes:
        - application/json
      parameters:
        - in: body
          name: rule
          required: true
          schema:
            $ref: '#/definitions/Rule'
      responses:
        '201':
          description: created
          schema:
            type: object
        '400':
          description: already exist
          schema:
            type: object

  /rules:
    get:
      tags:
        - "rules"
      description: get the list of the application rules
      operationId: getRules
      produces:
        - application/json
      parameters:
        - $ref: '#/parameters/appKey'
      responses:
        '200':
          description: success
          schema:
            type: array
            items:
              $ref: '#/definitions/Rule'
  /events:
    post:
      tags:
        - "events"
      description: send an event
      operationId: sendEvent
      consumes:
        - application/json
      parameters:
        - name: event
          in: body
          required: true
          schema:
            $ref: '#/definitions/Event'
      responses:
        '201':
          description: modified
          schema:
            type: object
parameters:
  badge:
    name: badge
    in: body
    required: true
    schema:
      $ref: '#/definitions/Badge'

  appKey:
    name: appKey
    in: header
    required: true
    type: integer

  badgeName:
    name: badgeName
    in: path
    required: true
    type: string

  username:
    name: username
    in: path
    required: true
    type: string

  pointScale:
    name: pointScale
    in: body
    required: true
    schema:
      $ref: '#/definitions/PointScale'

  pointScaleName:
    name: pointScaleName
    in: path
    required: true
    type: string

definitions:
  Badge:
    type: object
    properties:
      name:
        type: string
      description:
        type: string
      appKey:
        type: integer
    required:
      - name
      - description
      - appKey

  PointScale:
    type: object
    properties:
      name:
        type: string
      description:
        type: string
      appKey:
        type: integer
    required:
      - name
      - description
      - appKey

  Rule:
    type: object
    properties:
      appKey:
        type: integer
      name:
        type: string
      description:
        type: string
      points:
        type: integer
      pointScale:
        $ref: '#/definitions/PointScale'
      badge:
        $ref: '#/definitions/Badge'
    required:
      - appKey
      - name
      - description
      - points
      - pointScale
      - badge

  Event:
    type: object
    properties:
      appKey:
        type: integer
      rules:
        $ref: '#/definitions/Rule'
      username:
        type: string
    required:
      - appKey
      - rules
      - username
